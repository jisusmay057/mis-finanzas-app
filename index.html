<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Visual Data Finance</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0b0e14">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700;800&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="estilos.css">
</head>
<body>

    <div class="app-layout">
        
        <header class="app-header fade-in">
            <img src="logo.png" alt="Logo" class="header-logo" onerror="this.style.display='none'">
            <div>
                <h1 class="header-title">VISUAL DATA</h1>
                <small style="color:#718096; letter-spacing: 2px; font-size: 0.7rem; text-transform: uppercase;">Finance OS</small>
            </div>
        </header>

        <div id="toast" class="toast">Mensaje...</div>

        <nav class="top-nav">
            <button id="tab-registro" class="btn-nav activo" onclick="cambiarPestana('registro')">üìù Operar</button>
            <button id="tab-credito" class="btn-nav" onclick="cambiarPestana('credito')">üí≥ Cr√©dito</button>
            <button id="tab-dashboard" class="btn-nav" onclick="cambiarPestana('dashboard')">üìä Visual BI</button>
        </nav>

        <div id="vista-registro" class="vista fade-in">
            <div class="card-neon">
                <div class="switch-tipo">
                    <input type="radio" id="tipo-gasto" name="tipo" value="gasto" checked onclick="cambiarColorForm('gasto')">
                    <label for="tipo-gasto" class="lbl-gasto">üî¥ GASTO</label>

                    <input type="radio" id="tipo-pago" name="tipo" value="pago" onclick="cambiarColorForm('pago')">
                    <label for="tipo-pago" class="lbl-pago">üü¢ INGRESO/PAGO</label>
                </div>

                <form id="form-gasto" onsubmit="event.preventDefault(); guardarGasto();">
                    <div class="input-group">
                        <label>Descripci√≥n</label>
                        <input type="text" id="descripcion" placeholder="Ej: Supermercado..." required>
                    </div>

                    <div class="input-group">
                        <label>Medio de Pago</label>
                        <select id="metodo" onchange="verificarTarjeta()">
                            <option value="Efectivo/Debito">üíµ Efectivo / D√©bito</option>
                            <option value="BBVA">üí≥ BBVA</option>
                            <option value="Falabella">üí≥ Falabella</option>
                        </select>
                        <small id="aviso-ciclo" class="text-warning" style="display:none;"></small>
                    </div>

                    <div class="grid-2-col">
                        <div class="input-group">
                            <label>Monto (S/)</label>
                            <input type="number" id="monto" placeholder="0.00" step="0.01" required>
                        </div>
                        <div class="input-group" id="grupo-categoria">
                            <label>Categor√≠a</label>
                            <select id="categoria">
                                <option value="Alimentaci√≥n">üçî Comida</option>
                                <option value="Transporte">üöå Transporte</option>
                                <option value="Servicios">üè† Casa</option>
                                <option value="Entretenimiento">üéâ Ocio</option>
                                <option value="Salud">üíä Salud</option>
                                <option value="Deudas">üí∏ Deuda</option>
                                <option value="Otros">üì¶ Otros</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="input-group"><input type="text" id="notas" placeholder="Nota opcional..."></div>
                    <button type="submit" id="btn-agregar" class="btn-primary">REGISTRAR</button>
                </form>
            </div>

            <div class="lista-container">
                <h3>HISTORIAL</h3>
                <ul id="lista-gastos"><li style="text-align:center; color:#586577;">Cargando datos...</li></ul>
            </div>
        </div>

        <div id="vista-credito" class="vista oculto fade-in">
            <div class="kpi-card">
                <span>DEUDA TOTAL TARJETAS</span>
                <h1 id="deuda-total-global" class="text-neon-red">S/ 0.00</h1>
            </div>

            <h3 class="section-title">ESTADO DE LINEAS</h3>
            <div id="contenedor-tarjetas"></div>

            <div class="grid-2-col-chart" style="margin-top:20px;">
                <div class="card-neon-small">
                    <h4>Desglose BBVA</h4>
                    <div class="chart-mini"><canvas id="graficoBBVA"></canvas></div>
                </div>
                <div class="card-neon-small">
                    <h4>Desglose Falabella</h4>
                    <div class="chart-mini"><canvas id="graficoFalabella"></canvas></div>
                </div>
            </div>
        </div>

        <div id="vista-dashboard" class="vista oculto fade-in">
            
            <div class="card-neon calculator-box">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <h3 style="margin:0; color:#fff;">üí∞ SMART BUDGET</h3>
                    <button onclick="configurarPresupuesto()" class="btn-mini">‚öôÔ∏è Configurar</button>
                </div>
                
                <div class="calc-row">
                    <span>Ingreso Quincenal:</span>
                    <span id="calc-ingreso" style="color:#fff;">S/ 0.00</span>
                </div>
                <div class="calc-row">
                    <span>(-) Gastos Fijos/Pagos:</span>
                    <span id="calc-fijos" style="color:#ff9100;">S/ 0.00</span>
                </div>

                <hr style="border-color:#2d3748; margin: 10px 0;">

                <div class="calc-row highlight-box">
                    <span>üîí TU AHORRO (<span id="calc-porcentaje">0</span>%):</span>
                    <span id="calc-ahorro" style="color:#d500f9; font-weight:bold;">S/ 0.00</span>
                </div>

                <div style="margin-top: 15px;">
                    <span class="label-calc">YA GASTASTE EN CONSUMOS:</span>
                    <div id="calc-gastado-consumo" class="val-calc text-warning" style="font-size:1rem; margin-bottom:5px;">S/ 0.00</div>
                    
                    <span class="label-calc">DISPONIBLE REAL PARA GASTAR:</span>
                    <h1 id="calc-restante" class="text-neon-green" style="font-size: 2.2rem; margin:0;">S/ 0.00</h1>
                    <small id="calc-diario" style="color:#aaa; display:block; margin-top:5px;">(S/ 0.00 diarios hasta fin de quincena)</small>
                </div>
            </div>

            <h3 class="section-title">AN√ÅLISIS MACRO</h3>
            <div class="card-neon">
                <h4>Gasto Global por Categor√≠a</h4>
                <div class="chart-box-pie"><canvas id="graficoCategorias"></canvas></div>
            </div>

            <h3 class="section-title" style="margin-top: 30px;">HISTORIAL DE CONSUMO DIARIO</h3>
            <div class="card-neon">
                <p style="font-size: 0.7rem; color: #718096; margin-bottom: 10px;">üëá Desliza para ver d√≠as anteriores. <span style="color:#ff1744">ROJO</span> = Pico Alto.</p>
                <div class="scroll-chart-wrapper">
                    <div class="chart-long-container">
                        <canvas id="graficoMensual"></canvas>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <script src="script.js"></script>
</body>
</html>